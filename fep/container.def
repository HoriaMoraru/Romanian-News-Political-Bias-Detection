Bootstrap: docker
From: nvidia/cuda:12.1.1-cudnn8-runtime-ubuntu22.04

%post
    apt-get update && apt-get install -y \
        software-properties-common \
        curl git build-essential \
        python3.11 python3.11-venv python3.11-distutils python3.11-dev \
        wget && \
        rm -rf /var/lib/apt/lists/*

    ln -s /usr/bin/python3.11 /usr/local/bin/python
    curl -sS https://bootstrap.pypa.io/get-pip.py | python

    python -m venv /venv
    . /venv/bin/activate

    pip install --upgrade pip
    pip install -r /requirements.txt
    pip install nbconvert

%files
    ../requirements.txt /requirements.txt
    ../algorithm/NLP/media_bias_nlp.ipynb /notebook.ipynb
    ../dataset/romanian_political_articles_v1.csv /workspace/dataset/romanian_political_articles_v1.csv

%environment
    export VENV_PATH="/venv"
    export REQ_PATH="/requirements.txt"
    export NB_PATH="/notebook.ipynb"
    export PATH="/venv/bin:$PATH"
    source /venv/bin/activate

%runscript
    echo "Container built. Run manually with jupyter nbconvert or python."
